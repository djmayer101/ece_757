<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: DmaPort Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<h1>DmaPort Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="DmaPort" --><!-- doxytag: inherits="MasterPort" -->
<p><code>#include &lt;<a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for DmaPort:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classDmaPort.png" usemap="#DmaPort_map" alt=""/>
  <map id="DmaPort_map" name="DmaPort_map">
<area href="classMasterPort.html" alt="MasterPort" shape="rect" coords="0,112,238,136"/>
<area href="classBaseMasterPort.html" alt="BaseMasterPort" shape="rect" coords="0,56,238,80"/>
<area href="classPort.html" alt="Port" shape="rect" coords="0,0,238,24"/>
<area href="classArmISA_1_1TableWalker_1_1SnoopingDmaPort.html" alt="ArmISA::TableWalker::SnoopingDmaPort" shape="rect" coords="0,224,238,248"/>
</map>
</div>

<p><a href="classDmaPort-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDmaPort_1_1DmaReqState.html">DmaReqState</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a7bde2d5aa003406010c8073bc0a4eb8f">DmaPort</a> (<a class="el" href="classMemObject.html">MemObject</a> *dev, <a class="el" href="classSystem.html">System</a> *s)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a3201ee5c8e9eb266ed4945cfe859c998">dmaAction</a> (<a class="el" href="classMemCmd.html#ae5c39c2de0ad998b5176bc519b358102">Packet::Command</a> cmd, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr, int size, <a class="el" href="classEvent.html">Event</a> *event, uint8_t *data, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> delay, <a class="el" href="classFlags.html">Request::Flags</a> flag=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a1ba1cec7bbd667c3cdf08272e93a407c">dmaPending</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a3273ae2fe13a209790035986d9ca7371">cacheBlockSize</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a4b32fa5eddee7eab3af628f9504aa3de">drain</a> (<a class="el" href="classDrainManager.html">DrainManager</a> *drainManger)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#ab3cce1771374983ded2fa1da8a46f2fe">recvTimingResp</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive a timing response from the slave port.  <a href="#ab3cce1771374983ded2fa1da8a46f2fe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#aa322fc015562a1daced9504a4738fb3a">recvRetry</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called by the slave port if sendTimingReq or sendTimingSnoopResp was called on this master port (causing recvTimingReq and recvTimingSnoopResp to be called on the slave port) and was unsuccesful.  <a href="#aa322fc015562a1daced9504a4738fb3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a2c923b074a85208c85f2d7d14217bfca">queueDma</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a1fc6a86c574c13bcdbe819a8b394b079">trySendTimingReq</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Take the first packet of the transmit list and attempt to send it as a timing request.  <a href="#a1fc6a86c574c13bcdbe819a8b394b079"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a54d962324adccff96f5b248780ab3c96">sendDma</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For timing, attempt to send the first item on the transmit list, and if it is successful and there are more packets waiting, then schedule the sending of the next packet.  <a href="#a54d962324adccff96f5b248780ab3c96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a517e3bb6b4be3d57090a79728e4ea135">handleResp</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> delay=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle a response packet by updating the corresponding DMA request state to reflect the bytes received, and also update the pending request counter.  <a href="#a517e3bb6b4be3d57090a79728e4ea135"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMemObject.html">MemObject</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#afcec9887fb1b128fe93fa57694ea5e11">device</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The device that owns this port.  <a href="#afcec9887fb1b128fe93fa57694ea5e11"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classPacket.html">PacketPtr</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a7a2e3bf641af3f8634f2cbdde81689da">transmitList</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Use a deque as we never do any insertion or removal in the middle.  <a href="#a7a2e3bf641af3f8634f2cbdde81689da"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDmaPort.html">DmaPort</a>,&amp;DmaPort::sendDma &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#ade388b4ff6e4aeabbb55b7f8eea6ec8d">sendEvent</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classEvent.html">Event</a> used to schedule a future sending from the transmit list.  <a href="#ade388b4ff6e4aeabbb55b7f8eea6ec8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSystem.html">System</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a92dbc7fda8d2688c2c7fa383e0132e1a">sys</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The system that device/port are in.  <a href="#a92dbc7fda8d2688c2c7fa383e0132e1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="request_8hh.html#ac366b729262fd8e7cbd3283da6f775cf">MasterID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a327ee2ebd3e3fd1b29366412d2160dac">masterId</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Id for all requests.  <a href="#a327ee2ebd3e3fd1b29366412d2160dac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#acb51ae42a6f58d5fea54895b30ac5025">pendingCount</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of outstanding packets the dma port has.  <a href="#acb51ae42a6f58d5fea54895b30ac5025"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#a33eb9871db450a3d0e7428cfe83745fc">drainManager</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If we need to drain, keep the drain event around until we're done here.  <a href="#a33eb9871db450a3d0e7428cfe83745fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDmaPort.html#acd4abc058b09ca195833a1f89981b23f">inRetry</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If the port is currently waiting for a retry before it can send whatever it is that it's sending.  <a href="#acd4abc058b09ca195833a1f89981b23f"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00053">53</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7bde2d5aa003406010c8073bc0a4eb8f"></a><!-- doxytag: member="DmaPort::DmaPort" ref="a7bde2d5aa003406010c8073bc0a4eb8f" args="(MemObject *dev, System *s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DmaPort::DmaPort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemObject.html">MemObject</a> *&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSystem.html">System</a> *&nbsp;</td>
          <td class="paramname"> <em>s</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00051">51</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a3273ae2fe13a209790035986d9ca7371"></a><!-- doxytag: member="DmaPort::cacheBlockSize" ref="a3273ae2fe13a209790035986d9ca7371" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned DmaPort::cacheBlockSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00149">149</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>References <a class="el" href="port_8cc_source.html#l00159">MasterPort::peerBlockSize()</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8hh_source.html#l00181">DmaDevice::cacheBlockSize()</a>.</p>

</div>
</div>
<a class="anchor" id="a3201ee5c8e9eb266ed4945cfe859c998"></a><!-- doxytag: member="DmaPort::dmaAction" ref="a3201ee5c8e9eb266ed4945cfe859c998" args="(Packet::Command cmd, Addr addr, int size, Event *event, uint8_t *data, Tick delay, Request::Flags flag=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::dmaAction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classMemCmd.html#ae5c39c2de0ad998b5176bc519b358102">Packet::Command</a>&nbsp;</td>
          <td class="paramname"> <em>cmd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEvent.html">Event</a> *&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>delay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classFlags.html">Request::Flags</a>&nbsp;</td>
          <td class="paramname"> <em>flag</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00156">156</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="request_8hh_source.html#l00074">ContextSwitchTaskId::DMA</a>, <a class="el" href="trace_8hh_source.html#l00129">DPRINTF</a>, <a class="el" href="dma__device_8hh_source.html#l00120">masterId</a>, <a class="el" href="port_8cc_source.html#l00159">MasterPort::peerBlockSize()</a>, <a class="el" href="dma__device_8cc_source.html#l00189">queueDma()</a>, <a class="el" href="eventq_8hh_source.html#l00281">Event::scheduled()</a>, and <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8hh_source.html#l00169">DmaDevice::dmaRead()</a>, <a class="el" href="dma__device_8hh_source.html#l00163">DmaDevice::dmaWrite()</a>, <a class="el" href="table__walker_8cc_source.html#l00555">ArmISA::TableWalker::doL1Descriptor()</a>, <a class="el" href="copy__engine_8cc_source.html#l00445">CopyEngine::CopyEngineChannel::fetchDescriptor()</a>, <a class="el" href="copy__engine_8cc_source.html#l00606">CopyEngine::CopyEngineChannel::fetchNextAddr()</a>, <a class="el" href="pl111_8cc_source.html#l00457">Pl111::fillFifo()</a>, <a class="el" href="table__walker_8cc_source.html#l00247">ArmISA::TableWalker::processWalk()</a>, <a class="el" href="copy__engine_8cc_source.html#l00495">CopyEngine::CopyEngineChannel::readCopyBytes()</a>, <a class="el" href="copy__engine_8cc_source.html#l00585">CopyEngine::CopyEngineChannel::writeCompletionStatus()</a>, and <a class="el" href="copy__engine_8cc_source.html#l00516">CopyEngine::CopyEngineChannel::writeCopyBytes()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ba1cec7bbd667c3cdf08272e93a407c"></a><!-- doxytag: member="DmaPort::dmaPending" ref="a1ba1cec7bbd667c3cdf08272e93a407c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DmaPort::dmaPending </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00147">147</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>References <a class="el" href="dma__device_8hh_source.html#l00123">pendingCount</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8hh_source.html#l00175">DmaDevice::dmaPending()</a>.</p>

</div>
</div>
<a class="anchor" id="a4b32fa5eddee7eab3af628f9504aa3de"></a><!-- doxytag: member="DmaPort::drain" ref="a4b32fa5eddee7eab3af628f9504aa3de" args="(DrainManager *drainManger)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int DmaPort::drain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td>
          <td class="paramname"> <em>drainManger</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00139">139</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="trace_8hh_source.html#l00129">DPRINTF</a>, <a class="el" href="dma__device_8hh_source.html#l00127">drainManager</a>, and <a class="el" href="dma__device_8hh_source.html#l00123">pendingCount</a>.</p>

<p>Referenced by <a class="el" href="pcidev_8cc_source.html#l00162">PciDev::drain()</a>, <a class="el" href="i8254xGBe_8cc_source.html#l02056">IGbE::drain()</a>, <a class="el" href="dma__device_8cc_source.html#l00128">DmaDevice::drain()</a>, <a class="el" href="copy__engine_8cc_source.html#l00664">CopyEngine::drain()</a>, <a class="el" href="copy__engine_8cc_source.html#l00651">CopyEngine::CopyEngineChannel::drain()</a>, and <a class="el" href="table__walker_8cc_source.html#l00081">ArmISA::TableWalker::drain()</a>.</p>

</div>
</div>
<a class="anchor" id="a517e3bb6b4be3d57090a79728e4ea135"></a><!-- doxytag: member="DmaPort::handleResp" ref="a517e3bb6b4be3d57090a79728e4ea135" args="(PacketPtr pkt, Tick delay=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::handleResp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>delay</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle a response packet by updating the corresponding DMA request state to reflect the bytes received, and also update the pending request counter. </p>
<p>If the DMA request that this packet is part of is complete, then signal the completion event if present, potentially with a delay added to it.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>Response packet to handler </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>delay</em>&nbsp;</td><td>Additional delay for scheduling the completion event </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00059">59</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="packet_8hh_source.html#l00488">Packet::cmdString()</a>, <a class="el" href="core_8hh_source.html#l00045">curTick()</a>, <a class="el" href="dma__device_8hh_source.html#l00107">device</a>, <a class="el" href="request_8hh_source.html#l00074">ContextSwitchTaskId::DMA</a>, <a class="el" href="trace_8hh_source.html#l00129">DPRINTF</a>, <a class="el" href="dma__device_8hh_source.html#l00127">drainManager</a>, <a class="el" href="packet_8hh_source.html#l00552">Packet::getAddr()</a>, <a class="el" href="request_8hh_source.html#l00381">Request::getSize()</a>, <a class="el" href="packet_8hh_source.html#l00497">Packet::isResponse()</a>, <a class="el" href="dma__device_8hh_source.html#l00123">pendingCount</a>, <a class="el" href="packet_8hh_source.html#l00273">Packet::req</a>, <a class="el" href="eventq_8hh_source.html#l00442">EventManager::schedule()</a>, <a class="el" href="packet_8hh_source.html#l00445">Packet::senderState</a>, and <a class="el" href="drain_8hh_source.html#l00086">DrainManager::signalDrainDone()</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00105">recvTimingResp()</a>, and <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>.</p>

</div>
</div>
<a class="anchor" id="a2c923b074a85208c85f2d7d14217bfca"></a><!-- doxytag: member="DmaPort::queueDma" ref="a2c923b074a85208c85f2d7d14217bfca" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::queueDma </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00189">189</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="dma__device_8hh_source.html#l00123">pendingCount</a>, and <a class="el" href="dma__device_8hh_source.html#l00110">transmitList</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00156">dmaAction()</a>.</p>

</div>
</div>
<a class="anchor" id="aa322fc015562a1daced9504a4738fb3a"></a><!-- doxytag: member="DmaPort::recvRetry" ref="aa322fc015562a1daced9504a4738fb3a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::recvRetry </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Called by the slave port if sendTimingReq or sendTimingSnoopResp was called on this master port (causing recvTimingReq and recvTimingSnoopResp to be called on the slave port) and was unsuccesful. </p>

<p>Implements <a class="el" href="classMasterPort.html#a5e8dd5d5fdd573046bb1416a3c15a18f">MasterPort</a>.</p>

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00149">149</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="dma__device_8hh_source.html#l00110">transmitList</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

</div>
</div>
<a class="anchor" id="ab3cce1771374983ded2fa1da8a46f2fe"></a><!-- doxytag: member="DmaPort::recvTimingResp" ref="ab3cce1771374983ded2fa1da8a46f2fe" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DmaPort::recvTimingResp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Receive a timing response from the slave port. </p>

<p>Implements <a class="el" href="classMasterPort.html#a42a45bae958b6add2a5cd4e0b2147495">MasterPort</a>.</p>

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00105">105</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="dma__device_8cc_source.html#l00059">handleResp()</a>, <a class="el" href="packet_8hh_source.html#l00510">Packet::memInhibitAsserted()</a>, and <a class="el" href="packet_8hh_source.html#l00512">Packet::sharedAsserted()</a>.</p>

</div>
</div>
<a class="anchor" id="a54d962324adccff96f5b248780ab3c96"></a><!-- doxytag: member="DmaPort::sendDma" ref="a54d962324adccff96f5b248780ab3c96" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::sendDma </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>For timing, attempt to send the first item on the transmit list, and if it is successful and there are more packets waiting, then schedule the sending of the next packet. </p>
<p>For atomic, simply send and process everything on the transmit list. </p>

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00228">228</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="request_8hh_source.html#l00074">ContextSwitchTaskId::DMA</a>, <a class="el" href="trace_8hh_source.html#l00129">DPRINTF</a>, <a class="el" href="request_8hh_source.html#l00365">Request::getPaddr()</a>, <a class="el" href="request_8hh_source.html#l00381">Request::getSize()</a>, <a class="el" href="dma__device_8cc_source.html#l00059">handleResp()</a>, <a class="el" href="dma__device_8hh_source.html#l00131">inRetry</a>, <a class="el" href="sim_2system_8hh_source.html#l00135">System::isAtomicMode()</a>, <a class="el" href="sim_2system_8hh_source.html#l00146">System::isTimingMode()</a>, <a class="el" href="base_2misc_8hh_source.html#l00074">panic</a>, <a class="el" href="packet_8hh_source.html#l00273">Packet::req</a>, <a class="el" href="eventq_8hh_source.html#l00281">Event::scheduled()</a>, <a class="el" href="port_8cc_source.html#l00171">MasterPort::sendAtomic()</a>, <a class="el" href="dma__device_8hh_source.html#l00113">sendEvent</a>, <a class="el" href="dma__device_8hh_source.html#l00117">sys</a>, <a class="el" href="dma__device_8hh_source.html#l00110">transmitList</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00156">dmaAction()</a>.</p>

</div>
</div>
<a class="anchor" id="a1fc6a86c574c13bcdbe819a8b394b079"></a><!-- doxytag: member="DmaPort::trySendTimingReq" ref="a1fc6a86c574c13bcdbe819a8b394b079" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DmaPort::trySendTimingReq </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Take the first packet of the transmit list and attempt to send it as a timing request. </p>
<p>If it is successful, schedule the sending of the next packet, otherwise remember that we are waiting for a retry. </p>

<p>Definition at line <a class="el" href="dma__device_8cc_source.html#l00199">199</a> of file <a class="el" href="dma__device_8cc_source.html">dma_device.cc</a>.</p>

<p>References <a class="el" href="clocked__object_8hh_source.html#l00151">ClockedObject::clockEdge()</a>, <a class="el" href="packet_8hh_source.html#l00488">Packet::cmdString()</a>, <a class="el" href="dma__device_8hh_source.html#l00107">device</a>, <a class="el" href="request_8hh_source.html#l00074">ContextSwitchTaskId::DMA</a>, <a class="el" href="trace_8hh_source.html#l00129">DPRINTF</a>, <a class="el" href="packet_8hh_source.html#l00552">Packet::getAddr()</a>, <a class="el" href="dma__device_8hh_source.html#l00131">inRetry</a>, <a class="el" href="eventq_8hh_source.html#l00442">EventManager::schedule()</a>, <a class="el" href="dma__device_8hh_source.html#l00113">sendEvent</a>, <a class="el" href="port_8cc_source.html#l00185">MasterPort::sendTimingReq()</a>, and <a class="el" href="dma__device_8hh_source.html#l00110">transmitList</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00149">recvRetry()</a>, and <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="afcec9887fb1b128fe93fa57694ea5e11"></a><!-- doxytag: member="DmaPort::device" ref="afcec9887fb1b128fe93fa57694ea5e11" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMemObject.html">MemObject</a>* <a class="el" href="classDmaPort.html#afcec9887fb1b128fe93fa57694ea5e11">DmaPort::device</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The device that owns this port. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00107">107</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00059">handleResp()</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

</div>
</div>
<a class="anchor" id="a33eb9871db450a3d0e7428cfe83745fc"></a><!-- doxytag: member="DmaPort::drainManager" ref="a33eb9871db450a3d0e7428cfe83745fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainManager.html">DrainManager</a>* <a class="el" href="classDmaPort.html#a33eb9871db450a3d0e7428cfe83745fc">DmaPort::drainManager</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>If we need to drain, keep the drain event around until we're done here. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00127">127</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00139">drain()</a>, and <a class="el" href="dma__device_8cc_source.html#l00059">handleResp()</a>.</p>

</div>
</div>
<a class="anchor" id="acd4abc058b09ca195833a1f89981b23f"></a><!-- doxytag: member="DmaPort::inRetry" ref="acd4abc058b09ca195833a1f89981b23f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDmaPort.html#acd4abc058b09ca195833a1f89981b23f">DmaPort::inRetry</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>If the port is currently waiting for a retry before it can send whatever it is that it's sending. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00131">131</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

</div>
</div>
<a class="anchor" id="a327ee2ebd3e3fd1b29366412d2160dac"></a><!-- doxytag: member="DmaPort::masterId" ref="a327ee2ebd3e3fd1b29366412d2160dac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="request_8hh.html#ac366b729262fd8e7cbd3283da6f775cf">MasterID</a> <a class="el" href="classDmaPort.html#a327ee2ebd3e3fd1b29366412d2160dac">DmaPort::masterId</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Id for all requests. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00120">120</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00156">dmaAction()</a>.</p>

</div>
</div>
<a class="anchor" id="acb51ae42a6f58d5fea54895b30ac5025"></a><!-- doxytag: member="DmaPort::pendingCount" ref="acb51ae42a6f58d5fea54895b30ac5025" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDmaPort.html#acb51ae42a6f58d5fea54895b30ac5025">DmaPort::pendingCount</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of outstanding packets the dma port has. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00123">123</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8hh_source.html#l00147">dmaPending()</a>, <a class="el" href="dma__device_8cc_source.html#l00139">drain()</a>, <a class="el" href="dma__device_8cc_source.html#l00059">handleResp()</a>, and <a class="el" href="dma__device_8cc_source.html#l00189">queueDma()</a>.</p>

</div>
</div>
<a class="anchor" id="ade388b4ff6e4aeabbb55b7f8eea6ec8d"></a><!-- doxytag: member="DmaPort::sendEvent" ref="ade388b4ff6e4aeabbb55b7f8eea6ec8d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDmaPort.html">DmaPort</a>, &amp;DmaPort::sendDma&gt; <a class="el" href="classDmaPort.html#ade388b4ff6e4aeabbb55b7f8eea6ec8d">DmaPort::sendEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classEvent.html">Event</a> used to schedule a future sending from the transmit list. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00113">113</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

</div>
</div>
<a class="anchor" id="a92dbc7fda8d2688c2c7fa383e0132e1a"></a><!-- doxytag: member="DmaPort::sys" ref="a92dbc7fda8d2688c2c7fa383e0132e1a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSystem.html">System</a>* <a class="el" href="classDmaPort.html#a92dbc7fda8d2688c2c7fa383e0132e1a">DmaPort::sys</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The system that device/port are in. </p>
<p>This is used to select which mode we are currently operating in. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00117">117</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>.</p>

</div>
</div>
<a class="anchor" id="a7a2e3bf641af3f8634f2cbdde81689da"></a><!-- doxytag: member="DmaPort::transmitList" ref="a7a2e3bf641af3f8634f2cbdde81689da" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt;<a class="el" href="classPacket.html">PacketPtr</a>&gt; <a class="el" href="classDmaPort.html#a7a2e3bf641af3f8634f2cbdde81689da">DmaPort::transmitList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Use a deque as we never do any insertion or removal in the middle. </p>

<p>Definition at line <a class="el" href="dma__device_8hh_source.html#l00110">110</a> of file <a class="el" href="dma__device_8hh_source.html">dma_device.hh</a>.</p>

<p>Referenced by <a class="el" href="dma__device_8cc_source.html#l00189">queueDma()</a>, <a class="el" href="dma__device_8cc_source.html#l00149">recvRetry()</a>, <a class="el" href="dma__device_8cc_source.html#l00228">sendDma()</a>, and <a class="el" href="dma__device_8cc_source.html#l00199">trySendTimingReq()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>dev/<a class="el" href="dma__device_8hh_source.html">dma_device.hh</a></li>
<li>dev/<a class="el" href="dma__device_8cc_source.html">dma_device.cc</a></li>
</ul>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Sun Apr 7 2013 18:17:47 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.7.1</small></address>

</body>
</html>
