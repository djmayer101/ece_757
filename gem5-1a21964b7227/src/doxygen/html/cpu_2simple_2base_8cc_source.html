<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gem5: cpu/simple/base.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>cpu/simple/base.cc</h1>  </div>
</div>
<div class="contents">
<a href="cpu_2simple_2base_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2010-2012 ARM Limited</span>
<a name="l00003"></a>00003 <span class="comment"> * All rights reserved</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * The license below extends only to copyright in the software and shall</span>
<a name="l00006"></a>00006 <span class="comment"> * not be construed as granting a license to any other intellectual</span>
<a name="l00007"></a>00007 <span class="comment"> * property including but not limited to intellectual property relating</span>
<a name="l00008"></a>00008 <span class="comment"> * to a hardware implementation of the functionality of the software</span>
<a name="l00009"></a>00009 <span class="comment"> * licensed hereunder.  You may use the software subject to the license</span>
<a name="l00010"></a>00010 <span class="comment"> * terms below provided that you ensure that this notice is replicated</span>
<a name="l00011"></a>00011 <span class="comment"> * unmodified and in its entirety in all distributions of the software,</span>
<a name="l00012"></a>00012 <span class="comment"> * modified or unmodified, in source code or in binary form.</span>
<a name="l00013"></a>00013 <span class="comment"> *</span>
<a name="l00014"></a>00014 <span class="comment"> * Copyright (c) 2002-2005 The Regents of The University of Michigan</span>
<a name="l00015"></a>00015 <span class="comment"> * All rights reserved.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00018"></a>00018 <span class="comment"> * modification, are permitted provided that the following conditions are</span>
<a name="l00019"></a>00019 <span class="comment"> * met: redistributions of source code must retain the above copyright</span>
<a name="l00020"></a>00020 <span class="comment"> * notice, this list of conditions and the following disclaimer;</span>
<a name="l00021"></a>00021 <span class="comment"> * redistributions in binary form must reproduce the above copyright</span>
<a name="l00022"></a>00022 <span class="comment"> * notice, this list of conditions and the following disclaimer in the</span>
<a name="l00023"></a>00023 <span class="comment"> * documentation and/or other materials provided with the distribution;</span>
<a name="l00024"></a>00024 <span class="comment"> * neither the name of the copyright holders nor the names of its</span>
<a name="l00025"></a>00025 <span class="comment"> * contributors may be used to endorse or promote products derived from</span>
<a name="l00026"></a>00026 <span class="comment"> * this software without specific prior written permission.</span>
<a name="l00027"></a>00027 <span class="comment"> *</span>
<a name="l00028"></a>00028 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00029"></a>00029 <span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00030"></a>00030 <span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00031"></a>00031 <span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<a name="l00032"></a>00032 <span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<a name="l00033"></a>00033 <span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<a name="l00034"></a>00034 <span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00035"></a>00035 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00036"></a>00036 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00037"></a>00037 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<a name="l00038"></a>00038 <span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00039"></a>00039 <span class="comment"> *</span>
<a name="l00040"></a>00040 <span class="comment"> * Authors: Steve Reinhardt</span>
<a name="l00041"></a>00041 <span class="comment"> */</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &quot;arch/kernel_stats.hh&quot;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &quot;arch/stacktrace.hh&quot;</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include &quot;arch/tlb.hh&quot;</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include &quot;arch/utility.hh&quot;</span>
<a name="l00047"></a>00047 <span class="preprocessor">#include &quot;arch/vtophys.hh&quot;</span>
<a name="l00048"></a>00048 <span class="preprocessor">#include &quot;<a class="code" href="symtab_8hh.html">base/loader/symtab.hh</a>&quot;</span>
<a name="l00049"></a>00049 <span class="preprocessor">#include &quot;<a class="code" href="cp__annotate_8hh.html">base/cp_annotate.hh</a>&quot;</span>
<a name="l00050"></a>00050 <span class="preprocessor">#include &quot;<a class="code" href="cprintf_8hh.html">base/cprintf.hh</a>&quot;</span>
<a name="l00051"></a>00051 <span class="preprocessor">#include &quot;<a class="code" href="inifile_8hh.html" title="Declaration of IniFile object.">base/inifile.hh</a>&quot;</span>
<a name="l00052"></a>00052 <span class="preprocessor">#include &quot;<a class="code" href="base_2misc_8hh.html">base/misc.hh</a>&quot;</span>
<a name="l00053"></a>00053 <span class="preprocessor">#include &quot;<a class="code" href="pollevent_8hh.html">base/pollevent.hh</a>&quot;</span>
<a name="l00054"></a>00054 <span class="preprocessor">#include &quot;<a class="code" href="trace_8hh.html">base/trace.hh</a>&quot;</span>
<a name="l00055"></a>00055 <span class="preprocessor">#include &quot;<a class="code" href="base_2types_8hh.html" title="Defines global host-dependent types: Counter, Tick, and (indirectly) {int,uint}{8,16,32,64}_t.">base/types.hh</a>&quot;</span>
<a name="l00056"></a>00056 <span class="preprocessor">#include &quot;config/the_isa.hh&quot;</span>
<a name="l00057"></a>00057 <span class="preprocessor">#include &quot;<a class="code" href="cpu_2simple_2base_8hh.html">cpu/simple/base.hh</a>&quot;</span>
<a name="l00058"></a>00058 <span class="preprocessor">#include &quot;<a class="code" href="cpu_2base_8hh.html">cpu/base.hh</a>&quot;</span>
<a name="l00059"></a>00059 <span class="preprocessor">#include &quot;<a class="code" href="checker_2cpu_8hh.html">cpu/checker/cpu.hh</a>&quot;</span>
<a name="l00060"></a>00060 <span class="preprocessor">#include &quot;<a class="code" href="checker_2thread__context_8hh.html">cpu/checker/thread_context.hh</a>&quot;</span>
<a name="l00061"></a>00061 <span class="preprocessor">#include &quot;<a class="code" href="exetrace_8hh.html">cpu/exetrace.hh</a>&quot;</span>
<a name="l00062"></a>00062 <span class="preprocessor">#include &quot;<a class="code" href="profile_8hh.html">cpu/profile.hh</a>&quot;</span>
<a name="l00063"></a>00063 <span class="preprocessor">#include &quot;<a class="code" href="simple__thread_8hh.html">cpu/simple_thread.hh</a>&quot;</span>
<a name="l00064"></a>00064 <span class="preprocessor">#include &quot;<a class="code" href="smt_8hh.html" title="Defines SMT_MAX_THREADS.">cpu/smt.hh</a>&quot;</span>
<a name="l00065"></a>00065 <span class="preprocessor">#include &quot;<a class="code" href="cpu_2static__inst_8hh.html">cpu/static_inst.hh</a>&quot;</span>
<a name="l00066"></a>00066 <span class="preprocessor">#include &quot;<a class="code" href="thread__context_8hh.html">cpu/thread_context.hh</a>&quot;</span>
<a name="l00067"></a>00067 <span class="preprocessor">#include &quot;debug/Decode.hh&quot;</span>
<a name="l00068"></a>00068 <span class="preprocessor">#include &quot;debug/Fetch.hh&quot;</span>
<a name="l00069"></a>00069 <span class="preprocessor">#include &quot;debug/Quiesce.hh&quot;</span>
<a name="l00070"></a>00070 <span class="preprocessor">#include &quot;<a class="code" href="mem__object_8hh.html" title="MemObject declaration.">mem/mem_object.hh</a>&quot;</span>
<a name="l00071"></a>00071 <span class="preprocessor">#include &quot;<a class="code" href="packet_8hh.html" title="Declaration of the Packet class.">mem/packet.hh</a>&quot;</span>
<a name="l00072"></a>00072 <span class="preprocessor">#include &quot;<a class="code" href="request_8hh.html" title="Declaration of a request, the overall memory request consisting of the parts of the request that are ...">mem/request.hh</a>&quot;</span>
<a name="l00073"></a>00073 <span class="preprocessor">#include &quot;params/BaseSimpleCPU.hh&quot;</span>
<a name="l00074"></a>00074 <span class="preprocessor">#include &quot;<a class="code" href="byteswap_8hh.html">sim/byteswap.hh</a>&quot;</span>
<a name="l00075"></a>00075 <span class="preprocessor">#include &quot;<a class="code" href="sim_2debug_8hh.html">sim/debug.hh</a>&quot;</span>
<a name="l00076"></a>00076 <span class="preprocessor">#include &quot;<a class="code" href="sim_2faults_8hh.html">sim/faults.hh</a>&quot;</span>
<a name="l00077"></a>00077 <span class="preprocessor">#include &quot;<a class="code" href="full__system_8hh.html">sim/full_system.hh</a>&quot;</span>
<a name="l00078"></a>00078 <span class="preprocessor">#include &quot;<a class="code" href="sim__events_8hh.html">sim/sim_events.hh</a>&quot;</span>
<a name="l00079"></a>00079 <span class="preprocessor">#include &quot;<a class="code" href="sim__object_8hh.html">sim/sim_object.hh</a>&quot;</span>
<a name="l00080"></a>00080 <span class="preprocessor">#include &quot;<a class="code" href="stats_8hh.html">sim/stats.hh</a>&quot;</span>
<a name="l00081"></a>00081 <span class="preprocessor">#include &quot;<a class="code" href="sim_2system_8hh.html">sim/system.hh</a>&quot;</span>
<a name="l00082"></a>00082 
<a name="l00083"></a>00083 <span class="keyword">using namespace </span>std;
<a name="l00084"></a>00084 <span class="keyword">using namespace </span>TheISA;
<a name="l00085"></a>00085 
<a name="l00086"></a><a class="code" href="classBaseSimpleCPU.html#a6cbe27af7326aeeb9053eb9c1dcfc680">00086</a> <a class="code" href="classBaseSimpleCPU.html#a6cbe27af7326aeeb9053eb9c1dcfc680">BaseSimpleCPU::BaseSimpleCPU</a>(BaseSimpleCPUParams *<a class="code" href="namespaceMipsISA.html#ae12ae9e12fab22594609e2fefce7f7c2">p</a>)
<a name="l00087"></a>00087     : <a class="code" href="classBaseCPU.html">BaseCPU</a>(p), traceData(NULL), thread(NULL)
<a name="l00088"></a>00088 {
<a name="l00089"></a>00089     <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370" title="The FullSystem variable can be used to determine the current mode of simulation.">FullSystem</a>)
<a name="l00090"></a>00090         <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a> = <span class="keyword">new</span> <a class="code" href="classSimpleThread.html" title="The SimpleThread object provides a combination of the ThreadState object and the ThreadContext interf...">SimpleThread</a>(<span class="keyword">this</span>, 0, p-&gt;system, p-&gt;itb, p-&gt;dtb,
<a name="l00091"></a>00091                                   p-&gt;isa[0]);
<a name="l00092"></a>00092     <span class="keywordflow">else</span>
<a name="l00093"></a>00093         <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a> = <span class="keyword">new</span> <a class="code" href="classSimpleThread.html" title="The SimpleThread object provides a combination of the ThreadState object and the ThreadContext interf...">SimpleThread</a>(<span class="keyword">this</span>, <span class="comment">/* thread_num */</span> 0, p-&gt;system,
<a name="l00094"></a>00094                                   p-&gt;workload[0], p-&gt;itb, p-&gt;dtb, p-&gt;isa[0]);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a0ad3494bc0cd2f68845d9911ec254db7" title="Sets the status of this thread.">setStatus</a>(<a class="code" href="classThreadContext.html#a7b7149621d48abf9c88dd7ef28c3ede7a48c84e327dc1e92883d25b768ae191e9" title="Permanently shut down.">ThreadContext::Halted</a>);
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a> = <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a7da3f5e0fcea7bb73fce014f93bf2c0c" title="Returns the pointer to this SimpleThread&amp;#39;s ThreadContext.">getTC</a>();
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (p-&gt;checker) {
<a name="l00101"></a>00101         <a class="code" href="classBaseCPU.html">BaseCPU</a> *temp_checker = p-&gt;checker;
<a name="l00102"></a>00102         <a class="code" href="classBaseSimpleCPU.html#aacbd50a6bd42f585916eb8b39b939616">checker</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classCheckerCPU.html" title="CheckerCPU class.">CheckerCPU</a> *<span class="keyword">&gt;</span>(temp_checker);
<a name="l00103"></a>00103         <a class="code" href="classBaseSimpleCPU.html#aacbd50a6bd42f585916eb8b39b939616">checker</a>-&gt;<a class="code" href="classCheckerCPU.html#abeb99b4c4a9f07d2e083c89f88457b44">setSystem</a>(p-&gt;system);
<a name="l00104"></a>00104         <span class="comment">// Manipulate thread context</span>
<a name="l00105"></a>00105         <a class="code" href="classThreadContext.html" title="ThreadContext is the external interface to all thread state for anything outside of the CPU...">ThreadContext</a> *cpu_tc = <a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>;
<a name="l00106"></a>00106         <a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a> = <span class="keyword">new</span> <a class="code" href="classCheckerThreadContext.html" title="Derived ThreadContext class for use with the Checker.">CheckerThreadContext&lt;ThreadContext&gt;</a>(cpu_tc, this-&gt;<a class="code" href="classBaseSimpleCPU.html#aacbd50a6bd42f585916eb8b39b939616">checker</a>);
<a name="l00107"></a>00107     } <span class="keywordflow">else</span> {
<a name="l00108"></a>00108         <a class="code" href="classBaseSimpleCPU.html#aacbd50a6bd42f585916eb8b39b939616">checker</a> = NULL;
<a name="l00109"></a>00109     }
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <a class="code" href="classBaseSimpleCPU.html#a7490f7cac7b7ea86490b8a12cb8ef5b7">numInst</a> = 0;
<a name="l00112"></a>00112     <a class="code" href="classBaseSimpleCPU.html#a5734d247b7fcf897d765ab875469e9c0">startNumInst</a> = 0;
<a name="l00113"></a>00113     <a class="code" href="classBaseSimpleCPU.html#a993608c376f77731a627d10a818cfcf2">numOp</a> = 0;
<a name="l00114"></a>00114     <a class="code" href="classBaseSimpleCPU.html#a00a8db332170c1ffad7b96b4db17de14">startNumOp</a> = 0;
<a name="l00115"></a>00115     <a class="code" href="classBaseSimpleCPU.html#a23b8900df5c1d60413ecd43a2c7f2f33">numLoad</a> = 0;
<a name="l00116"></a>00116     <a class="code" href="classBaseSimpleCPU.html#a8d04099ba1cf18c47d8200a0593a598f">startNumLoad</a> = 0;
<a name="l00117"></a>00117     <a class="code" href="classBaseSimpleCPU.html#a739bb5beeeebfab6bb035432760258e6">lastIcacheStall</a> = 0;
<a name="l00118"></a>00118     <a class="code" href="classBaseSimpleCPU.html#a0bdd58c0fe479d88ab4f4c9ab523af24">lastDcacheStall</a> = 0;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <a class="code" href="classBaseCPU.html#a22178d56f16f4d27c17453771f334a88">threadContexts</a>.push_back(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122 
<a name="l00123"></a>00123     <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a> = 0;
<a name="l00124"></a>00124     <a class="code" href="classBaseSimpleCPU.html#a15483d2869b46930a1e62ae733a1b45f">stayAtPC</a> = <span class="keyword">false</span>;
<a name="l00125"></a>00125 }
<a name="l00126"></a>00126 
<a name="l00127"></a><a class="code" href="classBaseSimpleCPU.html#a9e4da8c845182af0f6824571a038fb77">00127</a> <a class="code" href="classBaseSimpleCPU.html#a9e4da8c845182af0f6824571a038fb77">BaseSimpleCPU::~BaseSimpleCPU</a>()
<a name="l00128"></a>00128 {
<a name="l00129"></a>00129 }
<a name="l00130"></a>00130 
<a name="l00131"></a>00131 <span class="keywordtype">void</span>
<a name="l00132"></a><a class="code" href="classBaseSimpleCPU.html#a066ccfe16fd02d871619fda43a28e79a">00132</a> <a class="code" href="classBaseSimpleCPU.html#a066ccfe16fd02d871619fda43a28e79a" title="Notify the CPU that the indicated context is now deallocated.">BaseSimpleCPU::deallocateContext</a>(<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b" title="Thread index/ID type.">ThreadID</a> thread_num)
<a name="l00133"></a>00133 {
<a name="l00134"></a>00134     <span class="comment">// for now, these are equivalent</span>
<a name="l00135"></a>00135     <a class="code" href="classBaseCPU.html#a678754a60d9b88b90b0920f9c2b078e3" title="Notify the CPU that the indicated context is now suspended.">suspendContext</a>(thread_num);
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 
<a name="l00139"></a>00139 <span class="keywordtype">void</span>
<a name="l00140"></a><a class="code" href="classBaseSimpleCPU.html#ad6d1ed581e51d87edbc7472ab88addd4">00140</a> <a class="code" href="classBaseSimpleCPU.html#ad6d1ed581e51d87edbc7472ab88addd4" title="Notify the CPU that the indicated context is now halted.">BaseSimpleCPU::haltContext</a>(<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b" title="Thread index/ID type.">ThreadID</a> thread_num)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142     <span class="comment">// for now, these are equivalent</span>
<a name="l00143"></a>00143     <a class="code" href="classBaseCPU.html#a678754a60d9b88b90b0920f9c2b078e3" title="Notify the CPU that the indicated context is now suspended.">suspendContext</a>(thread_num);
<a name="l00144"></a>00144 }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 <span class="keywordtype">void</span>
<a name="l00148"></a><a class="code" href="classBaseSimpleCPU.html#a6ba9f5c41f7a03512c3942809726f743">00148</a> <a class="code" href="classBaseSimpleCPU.html#a6ba9f5c41f7a03512c3942809726f743" title="Register statistics for this object.">BaseSimpleCPU::regStats</a>()
<a name="l00149"></a>00149 {
<a name="l00150"></a>00150     <span class="keyword">using namespace </span>Stats;
<a name="l00151"></a>00151 
<a name="l00152"></a>00152     <a class="code" href="classBaseSimpleCPU.html#a6ba9f5c41f7a03512c3942809726f743" title="Register statistics for this object.">BaseCPU::regStats</a>();
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <a class="code" href="classBaseSimpleCPU.html#a08a4734e5c8359bb018ed39dfc049e8a">numInsts</a>
<a name="l00155"></a>00155         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.committedInsts&quot;</span>)
<a name="l00156"></a>00156         .desc(<span class="stringliteral">&quot;Number of instructions committed&quot;</span>)
<a name="l00157"></a>00157         ;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <a class="code" href="classBaseSimpleCPU.html#af1c21f0050605dccc4a905c93df82d1e">numOps</a>
<a name="l00160"></a>00160         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.committedOps&quot;</span>)
<a name="l00161"></a>00161         .desc(<span class="stringliteral">&quot;Number of ops (including micro ops) committed&quot;</span>)
<a name="l00162"></a>00162         ;
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <a class="code" href="classBaseSimpleCPU.html#a78862caa247382f68558022ed3459a2b">numIntAluAccesses</a>
<a name="l00165"></a>00165         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_int_alu_accesses&quot;</span>)
<a name="l00166"></a>00166         .desc(<span class="stringliteral">&quot;Number of integer alu accesses&quot;</span>)
<a name="l00167"></a>00167         ;
<a name="l00168"></a>00168 
<a name="l00169"></a>00169     <a class="code" href="classBaseSimpleCPU.html#a92e4441d4c4489fae909a34333495ced">numFpAluAccesses</a>
<a name="l00170"></a>00170         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_fp_alu_accesses&quot;</span>)
<a name="l00171"></a>00171         .desc(<span class="stringliteral">&quot;Number of float alu accesses&quot;</span>)
<a name="l00172"></a>00172         ;
<a name="l00173"></a>00173 
<a name="l00174"></a>00174     <a class="code" href="classBaseSimpleCPU.html#a7b93383a26942fde16504e3064587eb4">numCallsReturns</a>
<a name="l00175"></a>00175         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_func_calls&quot;</span>)
<a name="l00176"></a>00176         .desc(<span class="stringliteral">&quot;number of times a function call or return occured&quot;</span>)
<a name="l00177"></a>00177         ;
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <a class="code" href="classBaseSimpleCPU.html#af8fec9bfa83e2c08e6c4aa0701a9786b">numCondCtrlInsts</a>
<a name="l00180"></a>00180         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_conditional_control_insts&quot;</span>)
<a name="l00181"></a>00181         .desc(<span class="stringliteral">&quot;number of instructions that are conditional controls&quot;</span>)
<a name="l00182"></a>00182         ;
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <a class="code" href="classBaseSimpleCPU.html#a6f079f8c42e0225140a9ceab4aa5a58c">numIntInsts</a>
<a name="l00185"></a>00185         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_int_insts&quot;</span>)
<a name="l00186"></a>00186         .desc(<span class="stringliteral">&quot;number of integer instructions&quot;</span>)
<a name="l00187"></a>00187         ;
<a name="l00188"></a>00188 
<a name="l00189"></a>00189     <a class="code" href="classBaseSimpleCPU.html#a058eb4a543b25184edd85729f055e6d3">numFpInsts</a>
<a name="l00190"></a>00190         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_fp_insts&quot;</span>)
<a name="l00191"></a>00191         .desc(<span class="stringliteral">&quot;number of float instructions&quot;</span>)
<a name="l00192"></a>00192         ;
<a name="l00193"></a>00193 
<a name="l00194"></a>00194     <a class="code" href="classBaseSimpleCPU.html#a6b7b623f9d2bff2c9a11d700d185d464">numIntRegReads</a>
<a name="l00195"></a>00195         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_int_register_reads&quot;</span>)
<a name="l00196"></a>00196         .desc(<span class="stringliteral">&quot;number of times the integer registers were read&quot;</span>)
<a name="l00197"></a>00197         ;
<a name="l00198"></a>00198 
<a name="l00199"></a>00199     <a class="code" href="classBaseSimpleCPU.html#ac90d4e309094cbc3f9398a013bac35f2">numIntRegWrites</a>
<a name="l00200"></a>00200         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_int_register_writes&quot;</span>)
<a name="l00201"></a>00201         .desc(<span class="stringliteral">&quot;number of times the integer registers were written&quot;</span>)
<a name="l00202"></a>00202         ;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <a class="code" href="classBaseSimpleCPU.html#a8d217b54bdd2766c1b45d8d21dbda753">numFpRegReads</a>
<a name="l00205"></a>00205         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_fp_register_reads&quot;</span>)
<a name="l00206"></a>00206         .desc(<span class="stringliteral">&quot;number of times the floating registers were read&quot;</span>)
<a name="l00207"></a>00207         ;
<a name="l00208"></a>00208 
<a name="l00209"></a>00209     <a class="code" href="classBaseSimpleCPU.html#a8ca21ef54069cc8d1bf6bc4a3ab5a12f">numFpRegWrites</a>
<a name="l00210"></a>00210         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_fp_register_writes&quot;</span>)
<a name="l00211"></a>00211         .desc(<span class="stringliteral">&quot;number of times the floating registers were written&quot;</span>)
<a name="l00212"></a>00212         ;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <a class="code" href="classBaseSimpleCPU.html#ac1b3fcbdd48d87892dfabb31e8de3708">numMemRefs</a>
<a name="l00215"></a>00215         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>()+<span class="stringliteral">&quot;.num_mem_refs&quot;</span>)
<a name="l00216"></a>00216         .desc(<span class="stringliteral">&quot;number of memory refs&quot;</span>)
<a name="l00217"></a>00217         ;
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     <a class="code" href="classBaseSimpleCPU.html#af28a4a72f6d566f938303cb29ba0214f">numStoreInsts</a>
<a name="l00220"></a>00220         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_store_insts&quot;</span>)
<a name="l00221"></a>00221         .desc(<span class="stringliteral">&quot;Number of store instructions&quot;</span>)
<a name="l00222"></a>00222         ;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224     <a class="code" href="classBaseSimpleCPU.html#a142996d0158217aa13095d8ccceea87e">numLoadInsts</a>
<a name="l00225"></a>00225         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_load_insts&quot;</span>)
<a name="l00226"></a>00226         .desc(<span class="stringliteral">&quot;Number of load instructions&quot;</span>)
<a name="l00227"></a>00227         ;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <a class="code" href="classBaseSimpleCPU.html#aaf55ab0bb573e20c49c80ad8310a1214">notIdleFraction</a>
<a name="l00230"></a>00230         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.not_idle_fraction&quot;</span>)
<a name="l00231"></a>00231         .desc(<span class="stringliteral">&quot;Percentage of non-idle cycles&quot;</span>)
<a name="l00232"></a>00232         ;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <a class="code" href="classBaseSimpleCPU.html#a68ca2081a99bf8cb1dfd4415917f931a">idleFraction</a>
<a name="l00235"></a>00235         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.idle_fraction&quot;</span>)
<a name="l00236"></a>00236         .desc(<span class="stringliteral">&quot;Percentage of idle cycles&quot;</span>)
<a name="l00237"></a>00237         ;
<a name="l00238"></a>00238 
<a name="l00239"></a>00239     <a class="code" href="classBaseSimpleCPU.html#ab595129bb527284dfe4f9c1c6cb5af8c">numBusyCycles</a>
<a name="l00240"></a>00240         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.num_busy_cycles&quot;</span>)
<a name="l00241"></a>00241         .desc(<span class="stringliteral">&quot;Number of busy cycles&quot;</span>)
<a name="l00242"></a>00242         ;
<a name="l00243"></a>00243 
<a name="l00244"></a>00244     <a class="code" href="classBaseSimpleCPU.html#a0c7d34ef49592cc15fc377fc2e2babc8">numIdleCycles</a>
<a name="l00245"></a>00245         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>()+<span class="stringliteral">&quot;.num_idle_cycles&quot;</span>)
<a name="l00246"></a>00246         .desc(<span class="stringliteral">&quot;Number of idle cycles&quot;</span>)
<a name="l00247"></a>00247         ;
<a name="l00248"></a>00248 
<a name="l00249"></a>00249     <a class="code" href="classBaseSimpleCPU.html#ad77c1de1fb7c9215616064010b90884c">icacheStallCycles</a>
<a name="l00250"></a>00250         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.icache_stall_cycles&quot;</span>)
<a name="l00251"></a>00251         .desc(<span class="stringliteral">&quot;ICache total stall cycles&quot;</span>)
<a name="l00252"></a>00252         .prereq(<a class="code" href="classBaseSimpleCPU.html#ad77c1de1fb7c9215616064010b90884c">icacheStallCycles</a>)
<a name="l00253"></a>00253         ;
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <a class="code" href="classBaseSimpleCPU.html#ae6b1258deb670c827fd19ef71b1d9b9a">dcacheStallCycles</a>
<a name="l00256"></a>00256         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.dcache_stall_cycles&quot;</span>)
<a name="l00257"></a>00257         .desc(<span class="stringliteral">&quot;DCache total stall cycles&quot;</span>)
<a name="l00258"></a>00258         .prereq(<a class="code" href="classBaseSimpleCPU.html#ae6b1258deb670c827fd19ef71b1d9b9a">dcacheStallCycles</a>)
<a name="l00259"></a>00259         ;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <a class="code" href="classBaseSimpleCPU.html#a7393b259b843fa7789d93a65d0597410">icacheRetryCycles</a>
<a name="l00262"></a>00262         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.icache_retry_cycles&quot;</span>)
<a name="l00263"></a>00263         .desc(<span class="stringliteral">&quot;ICache total retry cycles&quot;</span>)
<a name="l00264"></a>00264         .prereq(<a class="code" href="classBaseSimpleCPU.html#a7393b259b843fa7789d93a65d0597410">icacheRetryCycles</a>)
<a name="l00265"></a>00265         ;
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <a class="code" href="classBaseSimpleCPU.html#a0116244bd7cf2046438658bea98ff4d6">dcacheRetryCycles</a>
<a name="l00268"></a>00268         .<a class="code" href="classStats_1_1DataWrap.html#a8f6effeadf113613c8e96c732bef7228" title="Set the name and marks this stat to print at the end of simulation.">name</a>(<a class="code" href="classSimObject.html#a96c36bff06d98deb79d09e93652667ae">name</a>() + <span class="stringliteral">&quot;.dcache_retry_cycles&quot;</span>)
<a name="l00269"></a>00269         .desc(<span class="stringliteral">&quot;DCache total retry cycles&quot;</span>)
<a name="l00270"></a>00270         .prereq(<a class="code" href="classBaseSimpleCPU.html#a0116244bd7cf2046438658bea98ff4d6">dcacheRetryCycles</a>)
<a name="l00271"></a>00271         ;
<a name="l00272"></a>00272 
<a name="l00273"></a>00273     <a class="code" href="classBaseSimpleCPU.html#a68ca2081a99bf8cb1dfd4415917f931a">idleFraction</a> = <a class="code" href="namespaceStats.html#aee7bc2d5f58c9e1c5d24007800542032">constant</a>(1.0) - <a class="code" href="classBaseSimpleCPU.html#aaf55ab0bb573e20c49c80ad8310a1214">notIdleFraction</a>;
<a name="l00274"></a>00274     <a class="code" href="classBaseSimpleCPU.html#a0c7d34ef49592cc15fc377fc2e2babc8">numIdleCycles</a> = <a class="code" href="classBaseSimpleCPU.html#a68ca2081a99bf8cb1dfd4415917f931a">idleFraction</a> * <a class="code" href="classBaseCPU.html#a205aff3cc2e726632f492ccd4f45d3ca">numCycles</a>;
<a name="l00275"></a>00275     <a class="code" href="classBaseSimpleCPU.html#ab595129bb527284dfe4f9c1c6cb5af8c">numBusyCycles</a> = (<a class="code" href="classBaseSimpleCPU.html#aaf55ab0bb573e20c49c80ad8310a1214">notIdleFraction</a>)*<a class="code" href="classBaseCPU.html#a205aff3cc2e726632f492ccd4f45d3ca">numCycles</a>;
<a name="l00276"></a>00276 }
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 <span class="keywordtype">void</span>
<a name="l00279"></a><a class="code" href="classBaseSimpleCPU.html#ac93eb0132511fec316787a5dbb728b7c">00279</a> <a class="code" href="classBaseSimpleCPU.html#ac93eb0132511fec316787a5dbb728b7c" title="Reset statistics associated with this object.">BaseSimpleCPU::resetStats</a>()
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281 <span class="comment">//    startNumInst = numInst;</span>
<a name="l00282"></a>00282      <a class="code" href="classBaseSimpleCPU.html#aaf55ab0bb573e20c49c80ad8310a1214">notIdleFraction</a> = (<a class="code" href="classBaseSimpleCPU.html#a10a9927ef33b83d6cd4dbb90f2862181">_status</a> != Idle);
<a name="l00283"></a>00283 }
<a name="l00284"></a>00284 
<a name="l00285"></a>00285 <span class="keywordtype">void</span>
<a name="l00286"></a>00286 <a class="code" href="classBaseSimpleCPU.html#af94b6f4b9deb113559bc6f1ecccf41ff" title="Serialize a single thread.">BaseSimpleCPU::serializeThread</a>(ostream &amp;<a class="code" href="namespaceX86ISA.html#aea9fbab71662ba06cf536e05edfaaad1">os</a>, <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b" title="Thread index/ID type.">ThreadID</a> tid)
<a name="l00287"></a>00287 {
<a name="l00288"></a>00288     assert(<a class="code" href="classBaseSimpleCPU.html#a10a9927ef33b83d6cd4dbb90f2862181">_status</a> == <a class="code" href="classBaseSimpleCPU.html#a11b0e96158af07c6e2edfe028774238cafae0269c6164fdb111af106f09539323">Idle</a> || <a class="code" href="classBaseSimpleCPU.html#a10a9927ef33b83d6cd4dbb90f2862181">_status</a> == <a class="code" href="classBaseSimpleCPU.html#a11b0e96158af07c6e2edfe028774238ca84c8af944b2ef29375b90043bbf68de9">Running</a>);
<a name="l00289"></a>00289     assert(tid == 0);
<a name="l00290"></a>00290 
<a name="l00291"></a>00291     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a97155456fe991d2e7484d1babe8487d1">serialize</a>(os);
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00294"></a>00294 <span class="keywordtype">void</span>
<a name="l00295"></a>00295 <a class="code" href="classBaseSimpleCPU.html#a8fa895b89375a622051bd220c743e0e5" title="Unserialize one thread.">BaseSimpleCPU::unserializeThread</a>(<a class="code" href="classCheckpoint.html">Checkpoint</a> *cp, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;section,
<a name="l00296"></a>00296                                  <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b" title="Thread index/ID type.">ThreadID</a> tid)
<a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <span class="keywordflow">if</span> (tid != 0)
<a name="l00299"></a>00299         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Trying to load more than one thread into a SimpleCPU\n&quot;</span>);
<a name="l00300"></a>00300     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a8c96486e5fd057e4f0c3b3c10b560ff9">unserialize</a>(cp, section);
<a name="l00301"></a>00301 }
<a name="l00302"></a>00302 
<a name="l00303"></a>00303 <span class="keywordtype">void</span>
<a name="l00304"></a><a class="code" href="smt_8hh.html#aaebae07f0ebacbf1a4b445bc46cf4bc7">00304</a> <a class="code" href="cpu_2simple_2base_8cc.html#aaebae07f0ebacbf1a4b445bc46cf4bc7" title="Changes the status and priority of the thread with the given number.">change_thread_state</a>(<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b" title="Thread index/ID type.">ThreadID</a> tid, <span class="keywordtype">int</span> activate, <span class="keywordtype">int</span> priority)
<a name="l00305"></a>00305 {
<a name="l00306"></a>00306 }
<a name="l00307"></a>00307 
<a name="l00308"></a>00308 <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a>
<a name="l00309"></a><a class="code" href="classBaseSimpleCPU.html#ae14bdcb5f42150a99d0513e0e10e91e6">00309</a> <a class="code" href="classBaseSimpleCPU.html#ae14bdcb5f42150a99d0513e0e10e91e6">BaseSimpleCPU::dbg_vtophys</a>(<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a> <a class="code" href="namespaceX86ISA.html#a79b5c08c190167d17c9b9b3fd40112f6">addr</a>)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311     <span class="keywordflow">return</span> <a class="code" href="namespaceAlphaISA.html#a97aaf5bc76cca900eb38eadd7e8b0db5">vtophys</a>(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>, addr);
<a name="l00312"></a>00312 }
<a name="l00313"></a>00313 
<a name="l00314"></a>00314 <span class="keywordtype">void</span>
<a name="l00315"></a><a class="code" href="classBaseSimpleCPU.html#a3ff77fcb015bb29f2f067cb4ca3bb710">00315</a> <a class="code" href="classBaseSimpleCPU.html#a3ff77fcb015bb29f2f067cb4ca3bb710">BaseSimpleCPU::wakeup</a>()
<a name="l00316"></a>00316 {
<a name="l00317"></a>00317     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a544982d84ad9e748ebdd19aed920be6c" title="Returns the status of this thread.">status</a>() != ThreadContext::Suspended)
<a name="l00318"></a>00318         <span class="keywordflow">return</span>;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Quiesce,<span class="stringliteral">&quot;Suspended Processor awoke\n&quot;</span>);
<a name="l00321"></a>00321     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a11fcd9fd3f0629c22093347b4afba0a7" title="Set the status to Active.">activate</a>();
<a name="l00322"></a>00322 }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324 <span class="keywordtype">void</span>
<a name="l00325"></a><a class="code" href="classBaseSimpleCPU.html#a3e4cbf8767e698f193906151e081bedd">00325</a> <a class="code" href="classBaseSimpleCPU.html#a3e4cbf8767e698f193906151e081bedd">BaseSimpleCPU::checkForInterrupts</a>()
<a name="l00326"></a>00326 {
<a name="l00327"></a>00327     <span class="keywordflow">if</span> (<a class="code" href="classBaseCPU.html#aa97853abafd022b5076a90c76ba65d36">checkInterrupts</a>(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>)) {
<a name="l00328"></a>00328         <a class="code" href="classRefCountingPtr.html">Fault</a> interrupt = <a class="code" href="classBaseCPU.html#a28c30d48c15c3096813e4941f90226d7">interrupts</a>-&gt;getInterrupt(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>);
<a name="l00329"></a>00329 
<a name="l00330"></a>00330         <span class="keywordflow">if</span> (interrupt != <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>) {
<a name="l00331"></a>00331             <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a> = 0;
<a name="l00332"></a>00332             <a class="code" href="classBaseCPU.html#a28c30d48c15c3096813e4941f90226d7">interrupts</a>-&gt;updateIntrInfo(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>);
<a name="l00333"></a>00333             interrupt-&gt;invoke(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>);
<a name="l00334"></a>00334             <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#ad7291f70dd513844e04995d7d0598d70">decoder</a>.reset();
<a name="l00335"></a>00335         }
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337 }
<a name="l00338"></a>00338 
<a name="l00339"></a>00339 
<a name="l00340"></a>00340 <span class="keywordtype">void</span>
<a name="l00341"></a><a class="code" href="classBaseSimpleCPU.html#a9ec5f0ef84496e3679b1926f1c450e72">00341</a> <a class="code" href="classBaseSimpleCPU.html#a9ec5f0ef84496e3679b1926f1c450e72">BaseSimpleCPU::setupFetchRequest</a>(<a class="code" href="classRequest.html">Request</a> *req)
<a name="l00342"></a>00342 {
<a name="l00343"></a>00343     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a> <a class="code" href="classBaseSimpleCPU.html#a958055154e09fbc02ccb8190c3b885c5">instAddr</a> = <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#ae13a8a60b7d1aa44cb6e1087904934a8">instAddr</a>();
<a name="l00344"></a>00344 
<a name="l00345"></a>00345     <span class="comment">// set up memory request for instruction fetch</span>
<a name="l00346"></a>00346     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch: PC:%08p\n&quot;</span>, instAddr);
<a name="l00347"></a>00347 
<a name="l00348"></a>00348     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a> fetchPC = (instAddr &amp; <a class="code" href="classBaseCPU.html#a7aeea613cacb233763077cfc861b6ff3">PCMask</a>) + <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a>;
<a name="l00349"></a>00349     req-&gt;<a class="code" href="classRequest.html#a09207c906138b83b0b442928e998e63d" title="Set up a virtual (e.g., CPU) request in a previously allocated Request object.">setVirt</a>(0, fetchPC, <span class="keyword">sizeof</span>(<a class="code" href="namespaceAlphaISA.html#a63693d656cc2bf4bdd0de3e493eabe66">MachInst</a>), <a class="code" href="classRequest.html#a28c8ec6b7b6b21126adeb663dcca4cf9" title="The request was an instruction fetch.">Request::INST_FETCH</a>, <a class="code" href="classBaseCPU.html#a5afcf225b3ff14d5cb61d32f5211af7c" title="Reads this CPU&amp;#39;s unique instruction requestor ID.">instMasterId</a>(),
<a name="l00350"></a>00350             instAddr);
<a name="l00351"></a>00351 }
<a name="l00352"></a>00352 
<a name="l00353"></a>00353 
<a name="l00354"></a>00354 <span class="keywordtype">void</span>
<a name="l00355"></a><a class="code" href="classBaseSimpleCPU.html#afd61f01f4e1ffb85eff494734ce68e88">00355</a> <a class="code" href="classBaseSimpleCPU.html#afd61f01f4e1ffb85eff494734ce68e88">BaseSimpleCPU::preExecute</a>()
<a name="l00356"></a>00356 {
<a name="l00357"></a>00357     <span class="comment">// maintain $r0 semantics</span>
<a name="l00358"></a>00358     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a7bd7bf4d67e786dcb101c4f1071366fe">setIntReg</a>(<a class="code" href="namespaceAlphaISA.html#a7f37f910d53f6a7535037c4d47366260">ZeroReg</a>, 0);
<a name="l00359"></a>00359 <span class="preprocessor">#if THE_ISA == ALPHA_ISA</span>
<a name="l00360"></a>00360 <span class="preprocessor"></span>    <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#a4b227198d63b7a42c9f80dd111abf519">setFloatReg</a>(<a class="code" href="namespaceAlphaISA.html#a7f37f910d53f6a7535037c4d47366260">ZeroReg</a>, 0.0);
<a name="l00361"></a>00361 <span class="preprocessor">#endif // ALPHA_ISA</span>
<a name="l00362"></a>00362 <span class="preprocessor"></span>
<a name="l00363"></a>00363     <span class="comment">// check for instruction-count-based events</span>
<a name="l00364"></a>00364     <a class="code" href="classBaseCPU.html#a28a623d140582747e28b9396ebaaa328" title="Vector of per-thread instruction-based event queues.">comInstEventQueue</a>[0]-&gt;<a class="code" href="classEventQueue.html#a74bcdad13d45b55c9d44711e89f66e68">serviceEvents</a>(<a class="code" href="classBaseSimpleCPU.html#a7490f7cac7b7ea86490b8a12cb8ef5b7">numInst</a>);
<a name="l00365"></a>00365     <a class="code" href="classBaseCPU.html#aec7be52311ec347359ea6bffc40db74a">system</a>-&gt;<a class="code" href="classSystem.html#a22cf40f12beaedc9aa2090b46725385f">instEventQueue</a>.<a class="code" href="classEventQueue.html#a74bcdad13d45b55c9d44711e89f66e68">serviceEvents</a>(<a class="code" href="classBaseCPU.html#aec7be52311ec347359ea6bffc40db74a">system</a>-&gt;<a class="code" href="classSystem.html#ad0fe435fb9766a61216d5eb92d8b2c20">totalNumInsts</a>);
<a name="l00366"></a>00366 
<a name="l00367"></a>00367     <span class="comment">// decode the instruction</span>
<a name="l00368"></a>00368     <a class="code" href="classBaseSimpleCPU.html#a1fc11d911f6b8a1308324e86f81a9d24">inst</a> = <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(<a class="code" href="classBaseSimpleCPU.html#a1fc11d911f6b8a1308324e86f81a9d24">inst</a>);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370     <a class="code" href="namespaceAlphaISA.html#a233e755911c9143f96bef37eedb1e009">TheISA::PCState</a> <a class="code" href="classBaseSimpleCPU.html#a67965d274ad25d9ce3756fd15fbdaa15">pcState</a> = <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aac01d6afdb95c2a68442b54255549c79">pcState</a>();
<a name="l00371"></a>00371 
<a name="l00372"></a>00372     <span class="keywordflow">if</span> (<a class="code" href="base_2types_8hh.html#a01ec7071d9749218cc83949b3f93cd9b">isRomMicroPC</a>(pcState.microPC())) {
<a name="l00373"></a>00373         <a class="code" href="classBaseSimpleCPU.html#a15483d2869b46930a1e62ae733a1b45f">stayAtPC</a> = <span class="keyword">false</span>;
<a name="l00374"></a>00374         <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a> = <a class="code" href="classBaseCPU.html#a329b720ff7bd54b020fb22326843e2a1">microcodeRom</a>.fetchMicroop(pcState.microPC(),
<a name="l00375"></a>00375                                                   <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a>);
<a name="l00376"></a>00376     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a>) {
<a name="l00377"></a>00377         <span class="comment">//We&#39;re not in the middle of a macro instruction</span>
<a name="l00378"></a>00378         <a class="code" href="classRefCountingPtr.html">StaticInstPtr</a> instPtr = NULL;
<a name="l00379"></a>00379 
<a name="l00380"></a>00380         TheISA::Decoder *decoder = &amp;(<a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#ad7291f70dd513844e04995d7d0598d70">decoder</a>);
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <span class="comment">//Predecode, ie bundle up an ExtMachInst</span>
<a name="l00383"></a>00383         <span class="comment">//If more fetch data is needed, pass it in.</span>
<a name="l00384"></a>00384         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a> fetchPC = (pcState.instAddr() &amp; <a class="code" href="classBaseCPU.html#a7aeea613cacb233763077cfc861b6ff3">PCMask</a>) + <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a>;
<a name="l00385"></a>00385         <span class="comment">//if(decoder-&gt;needMoreBytes())</span>
<a name="l00386"></a>00386             decoder-&gt;moreBytes(pcState, fetchPC, <a class="code" href="classBaseSimpleCPU.html#a1fc11d911f6b8a1308324e86f81a9d24">inst</a>);
<a name="l00387"></a>00387         <span class="comment">//else</span>
<a name="l00388"></a>00388         <span class="comment">//    decoder-&gt;process();</span>
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="comment">//Decode an instruction if one is ready. Otherwise, we&#39;ll have to</span>
<a name="l00391"></a>00391         <span class="comment">//fetch beyond the MachInst at the current pc.</span>
<a name="l00392"></a>00392         instPtr = decoder-&gt;decode(pcState);
<a name="l00393"></a>00393         <span class="keywordflow">if</span> (instPtr) {
<a name="l00394"></a>00394             <a class="code" href="classBaseSimpleCPU.html#a15483d2869b46930a1e62ae733a1b45f">stayAtPC</a> = <span class="keyword">false</span>;
<a name="l00395"></a>00395             <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aac01d6afdb95c2a68442b54255549c79">pcState</a>(pcState);
<a name="l00396"></a>00396         } <span class="keywordflow">else</span> {
<a name="l00397"></a>00397             <a class="code" href="classBaseSimpleCPU.html#a15483d2869b46930a1e62ae733a1b45f">stayAtPC</a> = <span class="keyword">true</span>;
<a name="l00398"></a>00398             <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a> += <span class="keyword">sizeof</span>(MachInst);
<a name="l00399"></a>00399         }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401         <span class="comment">//If we decoded an instruction and it&#39;s microcoded, start pulling</span>
<a name="l00402"></a>00402         <span class="comment">//out micro ops</span>
<a name="l00403"></a>00403         <span class="keywordflow">if</span> (instPtr &amp;&amp; instPtr-&gt;isMacroop()) {
<a name="l00404"></a>00404             <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a> = instPtr;
<a name="l00405"></a>00405             <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a> = <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a>-&gt;fetchMicroop(pcState.microPC());
<a name="l00406"></a>00406         } <span class="keywordflow">else</span> {
<a name="l00407"></a>00407             <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a> = instPtr;
<a name="l00408"></a>00408         }
<a name="l00409"></a>00409     } <span class="keywordflow">else</span> {
<a name="l00410"></a>00410         <span class="comment">//Read the next micro op from the macro op</span>
<a name="l00411"></a>00411         <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a> = <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a>-&gt;fetchMicroop(pcState.microPC());
<a name="l00412"></a>00412     }
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     <span class="comment">//If we decoded an instruction this &quot;tick&quot;, record information about it.</span>
<a name="l00415"></a>00415     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>) {
<a name="l00416"></a>00416 <span class="preprocessor">#if TRACING_ON</span>
<a name="l00417"></a>00417 <span class="preprocessor"></span>        <a class="code" href="classBaseSimpleCPU.html#a1c5b42da4bb058bf584c14d4efe4e456">traceData</a> = <a class="code" href="classBaseCPU.html#a3c661671797f62911ab1a222f8238b5c">tracer</a>-&gt;<a class="code" href="classTrace_1_1InstTracer.html#aa43ed778722e8126eeb678ac5f3827bf">getInstRecord</a>(<a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The current simulated tick.">curTick</a>(), <a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>,
<a name="l00418"></a>00418                 <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>, <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aac01d6afdb95c2a68442b54255549c79">pcState</a>(), <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a>);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="namespaceThePipeline.html#a6fe6e0def324ecc663819b4cad987a2ba54cdad6d20f9a0eb3c4074462bb61a41">Decode</a>,<span class="stringliteral">&quot;Decode: Decoded %s instruction: %#x\n&quot;</span>,
<a name="l00421"></a>00421                 <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;getName(), <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;machInst);
<a name="l00422"></a>00422 <span class="preprocessor">#endif // TRACING_ON</span>
<a name="l00423"></a>00423 <span class="preprocessor"></span>    }
<a name="l00424"></a>00424 }
<a name="l00425"></a>00425 
<a name="l00426"></a>00426 <span class="keywordtype">void</span>
<a name="l00427"></a><a class="code" href="classBaseSimpleCPU.html#a59264184faf4bf78d00099b624183107">00427</a> <a class="code" href="classBaseSimpleCPU.html#a59264184faf4bf78d00099b624183107">BaseSimpleCPU::postExecute</a>()
<a name="l00428"></a>00428 {
<a name="l00429"></a>00429     assert(<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>);
<a name="l00430"></a>00430 
<a name="l00431"></a>00431     <a class="code" href="namespaceAlphaISA.html#a233e755911c9143f96bef37eedb1e009">TheISA::PCState</a> <a class="code" href="namespaceMipsISA.html#a4f7ed975e7137b5c369214789649451f">pc</a> = <a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>-&gt;<a class="code" href="classThreadContext.html#ab15f0db0e7c7afb40dfbbbd13d62dc2e">pcState</a>();
<a name="l00432"></a>00432     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232" title="Address type This will probably be moved somewhere else in the near future.">Addr</a> <a class="code" href="classBaseSimpleCPU.html#a958055154e09fbc02ccb8190c3b885c5">instAddr</a> = pc.instAddr();
<a name="l00433"></a>00433     <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370" title="The FullSystem variable can be used to determine the current mode of simulation.">FullSystem</a> &amp;&amp; <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="structThreadState.html#a97039e12e28f3b4acc3aeb7a9735c565">profile</a>) {
<a name="l00434"></a>00434         <span class="keywordtype">bool</span> usermode = <a class="code" href="namespaceAlphaISA.html#a166daa198f05f80c18b5249f18a0675e">TheISA::inUserMode</a>(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>);
<a name="l00435"></a>00435         <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="structThreadState.html#adadade1fac8554a49832ac6797892497">profilePC</a> = usermode ? 1 : instAddr;
<a name="l00436"></a>00436         <a class="code" href="classProfileNode.html">ProfileNode</a> *node = <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="structThreadState.html#a97039e12e28f3b4acc3aeb7a9735c565">profile</a>-&gt;<a class="code" href="classFunctionProfile.html#af97c20a88092a217f98bd768332e1396">consume</a>(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>, <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>);
<a name="l00437"></a>00437         <span class="keywordflow">if</span> (node)
<a name="l00438"></a>00438             <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="structThreadState.html#af58eaf34bd1dee8bdb42113ca0393534">profileNode</a> = node;
<a name="l00439"></a>00439     }
<a name="l00440"></a>00440 
<a name="l00441"></a>00441     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isMemRef()) {
<a name="l00442"></a>00442         <a class="code" href="classBaseSimpleCPU.html#ac1b3fcbdd48d87892dfabb31e8de3708">numMemRefs</a>++;
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isLoad()) {
<a name="l00446"></a>00446         ++<a class="code" href="classBaseSimpleCPU.html#a23b8900df5c1d60413ecd43a2c7f2f33">numLoad</a>;
<a name="l00447"></a>00447         <a class="code" href="classBaseCPU.html#ab8f5f1f1756c532d6e57fb2554846d9d" title="Vector of per-thread load-based event queues.">comLoadEventQueue</a>[0]-&gt;<a class="code" href="classEventQueue.html#a74bcdad13d45b55c9d44711e89f66e68">serviceEvents</a>(<a class="code" href="classBaseSimpleCPU.html#a23b8900df5c1d60413ecd43a2c7f2f33">numLoad</a>);
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="keywordflow">if</span> (<a class="code" href="classCPA.html#a7c7b6e4839b3111a143209b7b46a46fd">CPA::available</a>()) {
<a name="l00451"></a>00451         <a class="code" href="classCPA.html#a4718b022c7e507cc0c9dbb1e0dade621">CPA::cpa</a>()-&gt;<a class="code" href="classCPA.html#a1dfb0c2ea66bda04f95bf040bacd0642">swAutoBegin</a>(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>, pc.<a class="code" href="classThreadContext.html#ad1e9368e599faf3861a5834db79c13e8">nextInstAddr</a>());
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454     <span class="comment">/* Power model statistics */</span>
<a name="l00455"></a>00455     <span class="comment">//integer alu accesses</span>
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isInteger()){
<a name="l00457"></a>00457         <a class="code" href="classBaseSimpleCPU.html#a78862caa247382f68558022ed3459a2b">numIntAluAccesses</a>++;
<a name="l00458"></a>00458         <a class="code" href="classBaseSimpleCPU.html#a6f079f8c42e0225140a9ceab4aa5a58c">numIntInsts</a>++;
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="comment">//float alu accesses</span>
<a name="l00462"></a>00462     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isFloating()){
<a name="l00463"></a>00463         <a class="code" href="classBaseSimpleCPU.html#a92e4441d4c4489fae909a34333495ced">numFpAluAccesses</a>++;
<a name="l00464"></a>00464         <a class="code" href="classBaseSimpleCPU.html#a058eb4a543b25184edd85729f055e6d3">numFpInsts</a>++;
<a name="l00465"></a>00465     }
<a name="l00466"></a>00466     
<a name="l00467"></a>00467     <span class="comment">//number of function calls/returns to get window accesses</span>
<a name="l00468"></a>00468     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isCall() || <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isReturn()){
<a name="l00469"></a>00469         <a class="code" href="classBaseSimpleCPU.html#a7b93383a26942fde16504e3064587eb4">numCallsReturns</a>++;
<a name="l00470"></a>00470     }
<a name="l00471"></a>00471     
<a name="l00472"></a>00472     <span class="comment">//the number of branch predictions that will be made</span>
<a name="l00473"></a>00473     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isCondCtrl()){
<a name="l00474"></a>00474         <a class="code" href="classBaseSimpleCPU.html#af8fec9bfa83e2c08e6c4aa0701a9786b">numCondCtrlInsts</a>++;
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476     
<a name="l00477"></a>00477     <span class="comment">//result bus acceses</span>
<a name="l00478"></a>00478     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isLoad()){
<a name="l00479"></a>00479         <a class="code" href="classBaseSimpleCPU.html#a142996d0158217aa13095d8ccceea87e">numLoadInsts</a>++;
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481     
<a name="l00482"></a>00482     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isStore()){
<a name="l00483"></a>00483         <a class="code" href="classBaseSimpleCPU.html#af28a4a72f6d566f938303cb29ba0214f">numStoreInsts</a>++;
<a name="l00484"></a>00484     }
<a name="l00485"></a>00485     <span class="comment">/* End power model statistics */</span>
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370" title="The FullSystem variable can be used to determine the current mode of simulation.">FullSystem</a>)
<a name="l00488"></a>00488         <a class="code" href="classBaseCPU.html#a4419a21d0ddb50c7acd47a5ce8b4299a">traceFunctions</a>(instAddr);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490     <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a1c5b42da4bb058bf584c14d4efe4e456">traceData</a>) {
<a name="l00491"></a>00491         <a class="code" href="classBaseSimpleCPU.html#a1c5b42da4bb058bf584c14d4efe4e456">traceData</a>-&gt;<a class="code" href="classTrace_1_1InstRecord.html#a1c55c9048c47176c4ca727d94f8d6771">dump</a>();
<a name="l00492"></a>00492         <span class="keyword">delete</span> <a class="code" href="classBaseSimpleCPU.html#a1c5b42da4bb058bf584c14d4efe4e456">traceData</a>;
<a name="l00493"></a>00493         <a class="code" href="classBaseSimpleCPU.html#a1c5b42da4bb058bf584c14d4efe4e456">traceData</a> = NULL;
<a name="l00494"></a>00494     }
<a name="l00495"></a>00495 }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497 
<a name="l00498"></a>00498 <span class="keywordtype">void</span>
<a name="l00499"></a><a class="code" href="classBaseSimpleCPU.html#a1ca7acb41e96d7e1b851326fc5494afd">00499</a> <a class="code" href="classBaseSimpleCPU.html#a1ca7acb41e96d7e1b851326fc5494afd">BaseSimpleCPU::advancePC</a>(<a class="code" href="classRefCountingPtr.html">Fault</a> fault)
<a name="l00500"></a>00500 {
<a name="l00501"></a>00501     <span class="comment">//Since we&#39;re moving to a new pc, zero out the offset</span>
<a name="l00502"></a>00502     <a class="code" href="classBaseSimpleCPU.html#afb57c61efa50fcc79e5c1c1d67e19e11">fetchOffset</a> = 0;
<a name="l00503"></a>00503     <span class="keywordflow">if</span> (fault != <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>) {
<a name="l00504"></a>00504         <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a> = <a class="code" href="classStaticInst.html#a72613b9d07ecd43566ff4fac109ac689" title="Pointer to a statically allocated &amp;quot;null&amp;quot; instruction object.">StaticInst::nullStaticInstPtr</a>;
<a name="l00505"></a>00505         fault-&gt;invoke(<a class="code" href="classBaseSimpleCPU.html#a1d94ea1eaa23dd214f48d3833601941d" title="ThreadContext object, provides an interface for external objects to modify this thread&amp;#39;s state...">tc</a>, <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>);
<a name="l00506"></a>00506         <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#ad7291f70dd513844e04995d7d0598d70">decoder</a>.reset();
<a name="l00507"></a>00507     } <span class="keywordflow">else</span> {
<a name="l00508"></a>00508         <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>) {
<a name="l00509"></a>00509             <span class="keywordflow">if</span> (<a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>-&gt;isLastMicroop())
<a name="l00510"></a>00510                 <a class="code" href="classBaseSimpleCPU.html#a8af43f60ab6366f768575def72a813d0">curMacroStaticInst</a> = <a class="code" href="classStaticInst.html#a72613b9d07ecd43566ff4fac109ac689" title="Pointer to a statically allocated &amp;quot;null&amp;quot; instruction object.">StaticInst::nullStaticInstPtr</a>;
<a name="l00511"></a>00511             <a class="code" href="namespaceAlphaISA.html#a233e755911c9143f96bef37eedb1e009">TheISA::PCState</a> <a class="code" href="classBaseSimpleCPU.html#a67965d274ad25d9ce3756fd15fbdaa15">pcState</a> = <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aac01d6afdb95c2a68442b54255549c79">pcState</a>();
<a name="l00512"></a>00512             <a class="code" href="classBaseSimpleCPU.html#a1ca7acb41e96d7e1b851326fc5494afd">TheISA::advancePC</a>(pcState, <a class="code" href="classBaseSimpleCPU.html#a8bfe7f75498271dfe7323d2ac6b55938">curStaticInst</a>);
<a name="l00513"></a>00513             <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aac01d6afdb95c2a68442b54255549c79">pcState</a>(pcState);
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516 }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518 <span class="keywordtype">void</span>
<a name="l00519"></a><a class="code" href="classBaseSimpleCPU.html#a2e24c87d88b073c4790bacf887870840">00519</a> <a class="code" href="classBaseSimpleCPU.html#a2e24c87d88b073c4790bacf887870840" title="startup() is the final initialization call before simulation.">BaseSimpleCPU::startup</a>()
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521     <a class="code" href="classBaseSimpleCPU.html#a2e24c87d88b073c4790bacf887870840" title="startup() is the final initialization call before simulation.">BaseCPU::startup</a>();
<a name="l00522"></a>00522     <a class="code" href="classBaseSimpleCPU.html#a3b1d88fd3d64c7475fed2adb94515f7d" title="SimpleThread object, provides all the architectural state.">thread</a>-&gt;<a class="code" href="classSimpleThread.html#aadca9e06503ff11bd23faf7be42a783d">startup</a>();
<a name="l00523"></a>00523 }
</pre></div></div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"><address style="align: right;"><small>
Generated on Sun Apr 7 2013 18:16:11 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.7.1</small></address>

</body>
</html>
